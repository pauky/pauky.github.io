<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="杨润炜"><meta name="copyright" content="杨润炜"><title>Cwalker</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.2.0'
} </script><meta name="generator" content="Hexo 6.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">杨润炜</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">135</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">29</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">2</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Cwalker</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Cwalker</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/a/125.html">简单总结《改变未来的九大算法》（四）——数据库如何实例一致性</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/tech/">tech</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/read/">read</a></span><div class="content"><p>最近刚好在学习操作系统中的持久化实现，即文件系统。它与数据库的一些理念是相通的，所以将这篇算法复习一下，结合之后再总结出来。</p></div><a class="more" href="/a/125.html#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/124.html">简单总结《改变未来的九大算法》（三）——纠错码</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/tech/">tech</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/read/">read</a></span><div class="content"><p>问题：数据在网络传输可能会出错，如：数值缺失、数据变化（硬件故障、射线等，导致二进制数值变化）、数据被恶意更改等<br>历史上解决的方法有以下几种：</p></div><a class="more" href="/a/124.html#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/123.html">简单总结《改变未来的九大算法》（二）——公钥与数字签名</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/tech/">tech</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/read/">read</a></span><div class="content"><p>用图文的形式总结《改变未来的九大算法》中的公钥、数字签名、非对称加密算法基本原理与思想。</p></div><a class="more" href="/a/123.html#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/122.html">简单总结《改变未来的九大算法》（一）——搜索引擎</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/tech/">tech</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/read/">read</a></span><div class="content"><p><code>注：将用系列的方式总结，避免长篇，看起来累</code></p>
<p>《改变未来的九大算法》深入浅出的讲述了几个影响深远的伟大算法的基本原理与思想，在这里简单整理复述一下，也是响应作者的号召，让更多的人了解计算机背后的原理与思想。这里重点是抛砖引玉，因在下才疏学浅难免有错漏，强烈建议去阅读原作，阅读好快也是种美妙的体验~。</p></div><a class="more" href="/a/122.html#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/121.html">node.js异步方法的底层原理初探</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-02</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/tech/">tech</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/node-js/">node.js</a></span><div class="content"><p>作为node.js开发者，使用了它好几年。对于它能够通过单线程完成并发操作处理，一开始只觉得这工具用起来简单又高效，后来在操作系统和其它编程语言的学习中，看到了不少实现并发的方案，如多进程、多线程、协程、同步原语、锁、信号量，这些方案都伴随着一定的开发复杂度和且有系统稳定性风险，再回过头看node.js能提供如此简便的方案，不由心生好奇，想弄清楚它是怎样实现的。<br>之前也看过一些node.js原理的资料，但只是记得它们跟异步原理应该有关系。我想把它们和想要探索的问题关联起来，这样也能把之前学习的东西串起来，应该会有更大的收获。</p>
<p>以下我通过提问题再找答案的方式来解释这一原理。（提问题找解答的方式能使学习的目标感更强，让学习更有效率。）</p></div><a class="more" href="/a/121.html#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/120.html">关于http长连接的一个坑</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-02</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/tech/">tech</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/http/">http</a></span><div class="content"><h2 id="关于http长连接"><a href="#关于http长连接" class="headerlink" title="关于http长连接"></a>关于http长连接</h2><p>http1.1引入了长连接功能，为了解决连接复用，避免每次数据传输都需要tcp三次握手四次挥手的时间消耗。</p></div><a class="more" href="/a/120.html#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/119.html">来填坑，2021回顾与展望</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2022-01-01</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/life/">life</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/year-end-summary/">year end summary</a></span><div class="content"><p>又是一年过去了~ 在新年的第一天，来回顾下去年的经历，展望下新年的成长目标。</p>
<h2 id="回顾2021"><a href="#回顾2021" class="headerlink" title="回顾2021"></a>回顾2021</h2><h3 id="目标实现情况"><a href="#目标实现情况" class="headerlink" title="目标实现情况"></a>目标实现情况</h3><ol>
<li>要成功转入golang技术栈，实践至少3个项目；—— 100%</li>
<li>阅读并实践《CSAPP》、《UNIX环境高级编程》、《UNIX网络编程》、《自己动手写操作系统》等书；—— 30%</li>
<li>至少为1个出名的开源项目贡献代码（这个真的十分重要，也是我觉得很酷的事，写的东西能给很多很多人使用，且得到认可）；—— 50%</li>
</ol>
<h3 id="还是在不断啃书积累"><a href="#还是在不断啃书积累" class="headerlink" title="还是在不断啃书积累"></a>还是在不断啃书积累</h3><p>虽然从上面的目标实现情况，啃书目标完成度较低，是因为我发现除了《UNIX环境高级编程》、《UNIX网络编程》太像字典了，且工作上关联不了，很难消化，所以转战其它书籍。</p>
<h3 id="有所成长的地方"><a href="#有所成长的地方" class="headerlink" title="有所成长的地方"></a>有所成长的地方</h3><ul>
<li>技能上的提升：<br>  通过实践项目掌握golang、k8s的开发；<br>  掌握node.js底层原理；<br>  项目中运用设计模式理念优化代码，提升了对其的理解；<br>  数据结构与算法更加熟练；<br>  了解更多关于网络协议、数据库原理、操作系统原理的细节；</li>
<li>工作方式的转变，从只是被需求推着走，意识到需要理解需求背后的问题再去解决，并尝试推动团队按照这样的节奏进行。</li>
<li>学习方式的变化，有意识地从知识源头获取知识，如阅读官方文档特别是英文文档来深入了解新事物。</li>
<li>工作、生活状态上的改变，意识到反思的重要性，反思包括：多总结、多问为什么。</li>
</ul>
<h4 id="一些技术书和资料"><a href="#一些技术书和资料" class="headerlink" title="一些技术书和资料"></a>一些技术书和资料</h4><h5 id="《CSAPP》"><a href="#《CSAPP》" class="headerlink" title="《CSAPP》"></a>《CSAPP》</h5><p>阅读了一遍，笔记在<a target="_blank" rel="noopener" href="https://github.com/pauky/csapp-3e-note">这</a>，这本耗费了大半年时间，着实是硬啃下来的，但对知识边界的拓展效果也是显著的，至少现在碰到底层的问题可以不那么慌。</p>
<h5 id="《剑指Offer》"><a href="#《剑指Offer》" class="headerlink" title="《剑指Offer》"></a>《剑指Offer》</h5><p>看了两本关于剑指Offer的书，重新梳理下算法与数据结构的基础，加深对常见题型和解法的印象。有了前年的基础，读起来还是相对轻松些的，对自己的这点小前进也有点小激动。</p>
<h5 id="极客时间的资料"><a href="#极客时间的资料" class="headerlink" title="极客时间的资料"></a>极客时间的资料</h5><h6 id="《趣谈网络协议》"><a href="#《趣谈网络协议》" class="headerlink" title="《趣谈网络协议》"></a>《趣谈网络协议》</h6><p>加深对网络架构的理解，它能与我目前应用层开发的工作相关，比《图解TCP&#x2F;IP》、《TCP&#x2F;IP详解》更好接受一些。</p>
<h6 id="《MySQL》实战45讲"><a href="#《MySQL》实战45讲" class="headerlink" title="《MySQL》实战45讲"></a>《MySQL》实战45讲</h6><p>网上热度很高，虽然自己工作没在使用，但数据库一些理论还是比较接近的，所以可以尝试了解和比较下。从其中了解了底层的存储原理、数据库事务原理、性能优化的分析和技巧，很多时候能与算法、数据结构关联起来，有种学以致用的感觉，因为前面学的总算是用在点子上了。</p>
<h6 id="《深入剖析Kubernetes》"><a href="#《深入剖析Kubernetes》" class="headerlink" title="《深入剖析Kubernetes》"></a>《深入剖析Kubernetes》</h6><p>团队里在用k8s了，虽然平时用些基本的操作，但想更合理地解决业务问题，还是得更深入的理解它。其中对k8s的基本概念、原理、实践讲得很好，我从小白到入门还是挺轻松的。</p>
<h6 id="《Go语言编程模式实战》"><a href="#《Go语言编程模式实战》" class="headerlink" title="《Go语言编程模式实战》"></a>《Go语言编程模式实战》</h6><p>这是作者对Go开发的一些经验，站在高手的肩膀上，减少啃坑。</p>
<h6 id="《程序员的数学基础课》"><a href="#《程序员的数学基础课》" class="headerlink" title="《程序员的数学基础课》"></a>《程序员的数学基础课》</h6><p>难啃，年初看的，年底已经忘光了。。。关键还是没跟实际结合起来，虽然当时没有总结和实际，但我相信基础的知识总是要不断积累的，就像读书那会从幼儿园、小学、中学、大学一点点积累成长到现在，虽然有些阶段成长少，但也不能砍掉，后面总是依赖前面的积累，哪怕只是一丢丢丢。</p>
<h4 id="一些拓展的书"><a href="#一些拓展的书" class="headerlink" title="一些拓展的书"></a>一些拓展的书</h4><h5 id="《如何阅读一本书》"><a href="#《如何阅读一本书》" class="headerlink" title="《如何阅读一本书》"></a>《如何阅读一本书》</h5><p>对读书和阅读有了另外一层看法，加强了我对学习、解决问题关系的理解，了解了一些阅读的技巧。这是当时的<a target="_blank" rel="noopener" href="https://www.yangrunwei.com/a/117.html">读后感</a></p>
<h5 id="《影响力大师》如何调动团队力量"><a href="#《影响力大师》如何调动团队力量" class="headerlink" title="《影响力大师》如何调动团队力量"></a>《影响力大师》如何调动团队力量</h5><p>印象比较深的还是为团队提供合适的环境，且提供激励，让它顺利成长。这对我待在小公司的共鸣比较多，因为小公司往往都是各种试错、频繁赶进展的状态，团队在这种环境久了必然疲惫，反而降低了工作和产出效率。</p>
<h5 id="《活着》-amp-《围城》"><a href="#《活着》-amp-《围城》" class="headerlink" title="《活着》&amp; 《围城》"></a>《活着》&amp; 《围城》</h5><p>通勤时看的闲书，纯粹转换下思维，感受下他人的人生际遇（虽然是虚拟的）。</p>
<h3 id="参与开源"><a href="#参与开源" class="headerlink" title="参与开源"></a>参与开源</h3><p>开始逐渐把github用起来了，如看源码、提issue、提PR，参与项目：<br><a target="_blank" rel="noopener" href="https://github.com/jcupitt/docker-builds">https://github.com/jcupitt/docker-builds</a><br><a target="_blank" rel="noopener" href="https://github.com/h2non/bimg">https://github.com/h2non/bimg</a></p>
<blockquote>
<p>但提的PR还没被合到主干上~</p>
</blockquote>
<h3 id="欣喜的升级"><a href="#欣喜的升级" class="headerlink" title="欣喜的升级"></a>欣喜的升级</h3><ul>
<li>领红本升为人夫，十分欣喜，也觉责任之重。</li>
<li>成为两头猫的主人，平时生活的活力增加了不少，也觉得自己要逐渐懂得照顾他人了。</li>
</ul>
<h3 id="不足与反思"><a href="#不足与反思" class="headerlink" title="不足与反思"></a>不足与反思</h3><p>对于前一年的学习激情和自律性还是觉得不够，前半年还能保持一天看一两小时，后半年就懒散了。<br>缺少动手实践的投入，比较学会计算机底层，没能找到机会投入实践。<br>缺少总结，今年的博客量真心少，不过有些总结是在公司内网分享的，有机会倒是可以脱敏整理出来。</p>
<h2 id="展望2022"><a href="#展望2022" class="headerlink" title="展望2022"></a>展望2022</h2><h3 id="工作的规划"><a href="#工作的规划" class="headerlink" title="工作的规划"></a>工作的规划</h3><blockquote>
<p>悄咪咪说：准备换工作</p>
</blockquote>
<p>基于个人现状和规划，想到大厂工作。<br>小公司没那么多条框约束、管理上也相对扁平，如果潜力好的公司，个人的发挥空间会比较大。这是我这几年对小公司的一个相对客观的评价吧。<br>大公司没经历过，但基本的信息不会差太多，如人员的能力高度、丰富度，管理上的规范化（这里主要针对项目管理，如果人事管理确实是小公司好），对于目前经济形势在大公司比较有机会参与到影响力大的项目。基于这些，我决定选择大公司待一段时间，至少到能真正独挡一面、积累足够的人脉资源、感受下完善的严格的项目管理、甚至有机会构建影响深远的项目。</p>
<h3 id="生活的期待"><a href="#生活的期待" class="headerlink" title="生活的期待"></a>生活的期待</h3><p>积极准备再次升级，你懂的~</p>
<h3 id="用OKR立新flag"><a href="#用OKR立新flag" class="headerlink" title="用OKR立新flag"></a>用OKR立新flag</h3><ol>
<li>工作升级<br> 换份大厂工作，加薪30%；</li>
<li>学习升级<br> 写100份技术总结、20份杂记（读书笔记等）；<br> 掌握2000个单词；<br> 翻译10篇英文技术资料；<br> 熟练500道leetcode算法题；<br> 阅读并总结4本计算机原理的技术书籍；</li>
<li>技术升级<br> 成为golang优秀开源项目的代码贡献者，至少一个项目；<br> 增加c&#x2F;c++技术栈；</li>
<li>积极准备家庭身份升级，至少参加150天的keep；</li>
</ol>
<p>最后，希望今年能尽快结束疫情，听说特效药也出来了，可喜可贺！愿一切都能恢复如初。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/118.html">《诗经》检视阅读之感</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-11-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/life/">life</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/read/">read</a></span><div class="content"><p>周日心血来潮地速读了一遍《诗经》，起初的目的是为了给小外甥起名字找灵感，后来发现它的主体分明，适合用来检视阅读练习，再之后从后记译者的总结中看到了许多中华文化渊源，于此记下自己的感受，以便回顾。</p>
<h3 id="“元典”"><a href="#“元典”" class="headerlink" title="“元典”"></a>“元典”</h3><p>中华文化形成前期的主要元素。所以读起来有时候会感到熟悉，有种上辈子读过的感觉。</p>
<h3 id="开放的儒家文化"><a href="#开放的儒家文化" class="headerlink" title="开放的儒家文化"></a>开放的儒家文化</h3><p>没有之前对儒家的印象中“男女授受不亲”的那种约束，反而对这种事看作是日常生活的常态，在《诗经 ~ 风》里有不少描绘，感觉古人比现代的人还开放，对男女之事没有那么多世俗条框。</p>
<h3 id="温和敦厚"><a href="#温和敦厚" class="headerlink" title="温和敦厚"></a>温和敦厚</h3><p>通篇文字中给人的感觉就是温和、敦厚，有种“克制”的状态，这也深深植入到中国人的血液里代代流传。所谓“思无邪”、“乐而不淫，哀而不伤”，说的也是这种品质。</p>
<h3 id="不好战"><a href="#不好战" class="headerlink" title="不好战"></a>不好战</h3><p>首先民众对战争的态度是厌恶的，统治者即使描绘战争，也会把自己当正义之师，且常给人种悲壮的感觉，所以大家对战争是克制的，不会轻易去挑衅、奴隶别人，所以历史上中国再强大也不会去殖民周边的国家。</p>
<h3 id="信仰天，更信奉祖先"><a href="#信仰天，更信奉祖先" class="headerlink" title="信仰天，更信奉祖先"></a>信仰天，更信奉祖先</h3><p>中华上下五千年，没有长期单一的宗教，对宗教意识比较浅薄，但不代表没有信仰，因为从《诗经》中可以看出，那时候信仰的是天、是自然规律，现在也还是保留这样的传统。然而天有时候也会降低，比如《颂》里大部分都是祭祀祖先，为的是歌颂祖先的功德、祈求和平幸福。当危难发生时，会怨天，但会祈求祖先佑护，那时候相信人的力量大于天，所以中国人更信奉祖先。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/117.html">《如何阅读一本书》的感想与启发</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-10-31</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/life/">life</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/read/">read</a></span><div class="content"><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>我在生活中不缺少阅读的场景，比如看小说、读科普、看新闻甚至刷朋友圈、脸书、推特。然后当我阅读完这本书，才意识到之前所谓的阅读只不过是“走马观花”，而且“花”往往是资讯、消遣类的东西，除了在上学时“观”的是知识、经验，然大都是被动的获取——死记硬背而已。所以这本书<code>主要</code>在说的就是与这类相反的技巧、经验——要<code>主动地阅读</code>，什么是主动阅读，怎样主动阅读，以及为何要主动阅读。</p>
<h2 id="本书的总结"><a href="#本书的总结" class="headerlink" title="本书的总结"></a>本书的总结</h2><p>以下我将先用本书介绍的阅读技巧——分析阅读——来总结本书，也作为一个技巧练习的示例吧。</p>
<h4 id="本书的内容"><a href="#本书的内容" class="headerlink" title="本书的内容"></a>本书的内容</h4><p>这是一本实用类的书，作者讲述了阅读的技巧——主动阅读、提问、探寻结论，以及主动阅读能够增强心智、理解力的好处。</p>
<h4 id="作者如何论述的"><a href="#作者如何论述的" class="headerlink" title="作者如何论述的"></a>作者如何论述的</h4><p>总在来说是通过阅读的四个阶段来论述：</p>
<ul>
<li>基础阅读：识字，理解文字表面意思；</li>
<li>检视阅读：快速查阅，得出文字主旨；</li>
<li>分析阅读：理解作者在文中的假设、结论、想要解决以及未解决的问题，以及论述的逻辑，在阅读中不断提问、探寻答案，真正理解了作者在文本的主旨；</li>
<li>主题阅读：阅读的最终目标，结合不同作者的主旨，主动地探寻自己想要解决的问题。<br>四个阶段是层层递进，后者包含前者的。每一层的推进，都需要先提升自己的理解力到达一定的层次，当然还需要一些阅读技巧。<br>以上这些可以用在论述类的书，而对于非论述的书，作者也列举了常见非论述类型书的阅读技巧和经验。</li>
<li>历史书：除了了解非“真实”的故事，更需要从中得出适用于现实的经验；</li>
<li>科学、数学书：了解科学的历史和基本原理，知道其中的假设、分析、结论，不需要达到专家的理解水平；</li>
<li>哲学：由于抽象来源于自己的经验，所以需要了解作者及当时的社会背景，才有可能get到作者真正想说的，再加上自己的思考才能摸到作者的答案；</li>
<li>想象类文学（戏剧、诗）：不要去找共识和主旨或论述，它们是不具有逻辑的，唯一要做的是去感受与体验；</li>
<li>社会科学：一般与日常经验相符较容易入门阅读，但因涉及的领域广，边界模糊，所以往往很难真正下结论，特别是只从一本书中得出结论，所以要用主题阅读。<br>最后，作者也点明了阅读与心智成长的关系。</li>
</ul>
<h4 id="这本书是否真实？（它说得有道理吗？部分还是全部？）"><a href="#这本书是否真实？（它说得有道理吗？部分还是全部？）" class="headerlink" title="这本书是否真实？（它说得有道理吗？部分还是全部？）"></a>这本书是否真实？（它说得有道理吗？部分还是全部？）</h4><p>我觉得是十分符合经验的，且是能够启发出新的经验。</p>
<h4 id="这本书跟我有什么关系？"><a href="#这本书跟我有什么关系？" class="headerlink" title="这本书跟我有什么关系？"></a>这本书跟我有什么关系？</h4><p>让一个只会基础阅读的新手，感受到阅读的真正目标以及魅力。</p>
<p>以上就是我对本书的总结，取自对于印象和启发较多的部分，强烈推荐阅读本书获取更多的细节，因为其对于阅读新手来说信息量确实比较大。</p>
<h2 id="本书对我的启发"><a href="#本书对我的启发" class="headerlink" title="本书对我的启发"></a>本书对我的启发</h2><p>下面将来说下其对我的一些关于教育、学习的启发。</p>
<h3 id="教育方面"><a href="#教育方面" class="headerlink" title="教育方面"></a>教育方面</h3><p>读书那会常听到两个声音，读书有用或无用论，两派各持一词谁也说服不了谁。因为都能举出读书出人头地和诸如“上清华卖猪肉的例子”。先不探究事实是否如此，就拿自己读书、工作这段时间的感受来说，读书的利弊确实都有，利在于常规知识、经验的高效积累，这是普遍人自学难以匹敌的，而弊就是缺乏社会经历、人情世故、甚至是主动思考的意识。<br>然后读了本书我才意识到，其实教育的坏处应该不是教育本身产生的，而是作为当事人 我的问题。暂且不说社会经历，这块确实无法直接补充。但教育让人读书，为的是先让人识字、快速掌握常识，才有机会能够主动从书（或其它老师等知识传播的媒介）中增强自己对于社会、世界的理解力，增强心智的力量。</p>
<h3 id="学习方面"><a href="#学习方面" class="headerlink" title="学习方面"></a>学习方面</h3><p>学习不只是掌握新的技能，更要掌握能够发现问题、分析问题、尝试探寻答案的力量和经验。这是从本书自始至终强调地主动阅读，主动就是在阅读中不断提问题、找答案、总结的过程。</p>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>这本书一开始读了第一遍之后马上又进入第二遍，把重点的内容重新审视和思考，因为作者对于阅读应该主动的看法吸引了我，而当时一遍下来已经忘记了前面的很多问题本身以及论述。目前我的理解水平也只能得出这些体会和技巧，且觉得如果理解力再高一些肯定能体会得更多，所以这是一本值得后续多刷的好书。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/a/116.html">golang语言实践</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-14</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/tech/">tech</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/golang/">golang</a></span><div class="content"><h2 id="goroutine生命周期管理"><a href="#goroutine生命周期管理" class="headerlink" title="goroutine生命周期管理"></a>goroutine生命周期管理</h2><p>使用goroutine需要注意的点：</p>
<ol>
<li>启动goroutine后，需要有机制能控制其如何退出，避免goroutine泄漏造成系统不稳定的风险；</li>
<li>尽量让调用者来决定是否使用goroutine；</li>
</ol>
<p>注：强烈推荐看看文末引用里关于goroutine leak的文章</p>
<h3 id="反例"><a href="#反例" class="headerlink" title="反例"></a>反例</h3><p>下面无法控制goroutine的例子，只能靠log.Fatal调用底层的os.exit退出，但这会使整个进程退出，有些正在处理的状态会因此中断，产生不可预料的异常；<br>在startServer内使用goroutine，调用者main函数并不知道其使用了goroutine，实际场景下可能会遗漏管理其非阻塞的特征。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;log&quot;</span><br><span class="line">	&quot;net/http&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	// some goroutine...</span><br><span class="line">	startApp()</span><br><span class="line">	startDebug()</span><br><span class="line">	select &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func startApp() &#123;</span><br><span class="line">	go func() &#123;</span><br><span class="line">		if err := http.ListenAndServe(&quot;:8080&quot;, nil); err != nil &#123;</span><br><span class="line">			log.Fatal(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func startDebug() &#123;</span><br><span class="line">	go func() &#123;</span><br><span class="line">		if err := http.ListenAndServe(&quot;:8081&quot;, nil); err != nil &#123;</span><br><span class="line">			log.Fatal(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用chan管理"><a href="#使用chan管理" class="headerlink" title="使用chan管理"></a>使用chan管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;context&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;log&quot;</span><br><span class="line">	&quot;net/http&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func startServer(addr string, stop &lt;-chan struct&#123;&#125;) error &#123;</span><br><span class="line"></span><br><span class="line">	mux := http.NewServeMux()</span><br><span class="line">	mux.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">		fmt.Fprintf(w, &quot;GET / OK&quot;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	s := http.Server&#123;</span><br><span class="line">		Addr:    addr,</span><br><span class="line">		Handler: mux,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		&lt;-stop</span><br><span class="line">		log.Printf(&quot;addr: %s shuntDown&quot;, addr)</span><br><span class="line">		s.Shutdown(context.Background())</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	return s.ListenAndServe()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	stop := make(chan struct&#123;&#125;)</span><br><span class="line">	done := make(chan error, 2)</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		done &lt;- startServer(&quot;:8080&quot;, stop) // app</span><br><span class="line">	&#125;()</span><br><span class="line">	go func() &#123;</span><br><span class="line">		done &lt;- startServer(&quot;:8081&quot;, stop) // debug</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	for i := 0; i &lt; cap(done); i++ &#123;</span><br><span class="line">		if err := &lt;-done; err != nil &#123;</span><br><span class="line">			close(stop)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用context管理"><a href="#使用context管理" class="headerlink" title="使用context管理"></a>使用context管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;context&quot;</span><br><span class="line">	&quot;log&quot;</span><br><span class="line">	&quot;net/http&quot;</span><br><span class="line">	&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func startServer(ctx context.Context, addr string) error &#123;</span><br><span class="line"></span><br><span class="line">	s := http.Server&#123;</span><br><span class="line">		Addr: addr,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	go func(ctx context.Context) &#123;</span><br><span class="line">		&lt;-ctx.Done()</span><br><span class="line">		log.Printf(&quot;addr: %s shuntDown&quot;, addr)</span><br><span class="line">		s.Shutdown(ctx)</span><br><span class="line">	&#125;(ctx)</span><br><span class="line"></span><br><span class="line">	log.Printf(&quot;addr: %s start&quot;, addr)</span><br><span class="line">	return s.ListenAndServe()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line"></span><br><span class="line">	ctx, cancel := context.WithCancel(context.Background())</span><br><span class="line">	go func() &#123;</span><br><span class="line">		startServer(ctx, &quot;:8080&quot;) // app</span><br><span class="line">	&#125;()</span><br><span class="line">	go func() &#123;</span><br><span class="line">		startServer(ctx, &quot;:8081&quot;) // debug</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	cancel()</span><br><span class="line">	select &#123;</span><br><span class="line">	case &lt;-time.After(2 * time.Second):</span><br><span class="line">		log.Print(&quot;done&quot;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用errgroup管理"><a href="#使用errgroup管理" class="headerlink" title="使用errgroup管理"></a>使用errgroup管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;context&quot;</span><br><span class="line">	&quot;errors&quot;</span><br><span class="line">	&quot;log&quot;</span><br><span class="line">	&quot;net/http&quot;</span><br><span class="line">	&quot;time&quot;</span><br><span class="line"></span><br><span class="line">	&quot;golang.org/x/sync/errgroup&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	g, ctx := errgroup.WithContext(context.Background())</span><br><span class="line">	g.Go(func() error &#123;</span><br><span class="line">		return startServer(ctx, &quot;3000&quot;)</span><br><span class="line">	&#125;)</span><br><span class="line">	g.Go(func() error &#123;</span><br><span class="line">		return startServer(ctx, &quot;4000&quot;)</span><br><span class="line">	&#125;)</span><br><span class="line">	g.Go(func() error &#123;</span><br><span class="line">		time.Sleep(2 * time.Second)</span><br><span class="line">		return errors.New(&quot;it&#x27;s time to exit&quot;)</span><br><span class="line">	&#125;)</span><br><span class="line">	err := g.Wait()</span><br><span class="line">	log.Printf(&quot;exit, err: %v\n&quot;, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func startServer(ctx context.Context, port string) error &#123;</span><br><span class="line">	log.Printf(&quot;startServer: %s\n&quot;, port)</span><br><span class="line">	srv := http.Server&#123;Addr: &quot;:&quot; + port&#125;</span><br><span class="line">	go func(ctx context.Context) &#123;</span><br><span class="line">		&lt;-ctx.Done()</span><br><span class="line">		if err := srv.Shutdown(ctx); err != nil &#123;</span><br><span class="line">			log.Printf(&quot;HTTP server %s Shutdown error: %v&quot;, srv.Addr, err)</span><br><span class="line">		&#125;</span><br><span class="line">		log.Printf(&quot;HTTP server %s Shutdown successfully&quot;, srv.Addr)</span><br><span class="line">	&#125;(ctx)</span><br><span class="line"></span><br><span class="line">	return srv.ListenAndServe()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><ol>
<li>error是一个值，而不是异常；</li>
<li>panic意味着程序挂了，谨慎使用；</li>
<li>errors.New返回指针类型，详情看<a target="_blank" rel="noopener" href="https://golang.org/src/errors/errors.go">error源码</a>；</li>
<li>使用errors.Wrapf跟踪错误堆栈；</li>
</ol>
<h3 id="errors-New返回指针的原因"><a href="#errors-New返回指针的原因" class="headerlink" title="errors.New返回指针的原因"></a>errors.New返回指针的原因</h3><p>errors.New返回的是指针，能够避免error字符串相同导致错误被误以为一致。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;errors&quot;</span><br><span class="line">	&quot;log&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type myErrorString struct &#123;</span><br><span class="line">	s string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (e myErrorString) Error() string &#123;</span><br><span class="line">	return e.s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// New create my error</span><br><span class="line">func New(s string) error &#123;</span><br><span class="line">	return myErrorString&#123;s&#125; // 这里返回的是字符串，而errors.New返回的是指针</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line"></span><br><span class="line">	var err1 = errors.New(&quot;test_err&quot;)</span><br><span class="line">	var err2 = errors.New(&quot;test_err&quot;)</span><br><span class="line"></span><br><span class="line">	if err1 == err2 &#123;</span><br><span class="line">		log.Println(&quot;err1 == err2&quot;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	var err3 = New(&quot;test_err&quot;)</span><br><span class="line">	var err4 = New(&quot;test_err&quot;)</span><br><span class="line">	if err3 == err4 &#123;</span><br><span class="line">		log.Println(&quot;err3 == err4&quot;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="用errors-Wrapf跟踪异常的堆栈信息"><a href="#用errors-Wrapf跟踪异常的堆栈信息" class="headerlink" title="用errors.Wrapf跟踪异常的堆栈信息"></a>用errors.Wrapf跟踪异常的堆栈信息</h3><h4 id="使用系统内置errors"><a href="#使用系统内置errors" class="headerlink" title="使用系统内置errors"></a>使用系统内置errors</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;log&quot;</span><br><span class="line"></span><br><span class="line">	&quot;errors&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// ErrNotFound some data is not found</span><br><span class="line">var ErrNotFound = errors.New(&quot;not found&quot;)</span><br><span class="line"></span><br><span class="line">func dao(id string) (interface&#123;&#125;, error) &#123;</span><br><span class="line">	return nil, errors.New(&quot;not found&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func service(id string) (interface&#123;&#125;, error) &#123;</span><br><span class="line">	data, err := dao(id)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	return data, nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func api() &#123;</span><br><span class="line">	id := &quot;test&quot;</span><br><span class="line">	data, err := service(id)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		// only print: &quot;err: not found&quot;</span><br><span class="line">		log.Printf(&quot;err: %+v\n&quot;, err)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line">	log.Printf(&quot;found data: %+v\n&quot;, data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	api()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="从errors-Wrapf拿到错误堆栈信息"><a href="#从errors-Wrapf拿到错误堆栈信息" class="headerlink" title="从errors.Wrapf拿到错误堆栈信息"></a>从errors.Wrapf拿到错误堆栈信息</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;log&quot;</span><br><span class="line"></span><br><span class="line">	&quot;github.com/pkg/errors&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// ErrNotFound some data is not found</span><br><span class="line">var ErrNotFound = errors.New(&quot;not found&quot;)</span><br><span class="line"></span><br><span class="line">func dao(id string) (interface&#123;&#125;, error) &#123;</span><br><span class="line">	return nil, errors.Wrapf(ErrNotFound, &quot;id: %s is not found&quot;, id)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func service(id string) (interface&#123;&#125;, error) &#123;</span><br><span class="line">	data, err := dao(id)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line">	return data, nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func api() &#123;</span><br><span class="line">	id := &quot;test&quot;</span><br><span class="line">	data, err := service(id)</span><br><span class="line">	if errors.Cause(err) == ErrNotFound &#123;</span><br><span class="line">		// 打印出错误的堆栈</span><br><span class="line">		log.Printf(&quot;stack trace: \n%+v\n&quot;, err)</span><br><span class="line"></span><br><span class="line">		// 只打印根错误</span><br><span class="line">		log.Printf(&quot;original err: %+v\n&quot;, errors.Cause(err))</span><br><span class="line"></span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line">	log.Printf(&quot;found data: %+v\n&quot;, data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	api()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="context的应用"><a href="#context的应用" class="headerlink" title="context的应用"></a>context的应用</h2><ol>
<li>级联取消goroutine；</li>
<li>数据共享、传递；</li>
</ol>
<h3 id="级联取消goroutine"><a href="#级联取消goroutine" class="headerlink" title="级联取消goroutine;"></a>级联取消goroutine;</h3><p><img src="/assets/uploads/files/1615129527838-4ec10931-66fc-4534-b4c1-06c93dc573ab-image-resized.png" alt="0_1615129527189_4ec10931-66fc-4534-b4c1-06c93dc573ab-image.png"><br>见上文中goroutine生命周期管理的【使用context管理】的代码。</p>
<h3 id="数据共享、传递"><a href="#数据共享、传递" class="headerlink" title="数据共享、传递"></a>数据共享、传递</h3><p>context可以存储kv数据，且数据可以通过context.WithValue传递给子函数，如果子函数从当前context的kv找不到，会自动递归父级的context查找，直到找到或父级为nil。<br><img src="/assets/uploads/files/1615128229433-8a198b9a-cd0f-4cbb-b8fa-ae2fea26193f-image-resized.png" alt="0_1615128228780_8a198b9a-cd0f-4cbb-b8fa-ae2fea26193f-image.png"> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;context&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type favContextKey string</span><br><span class="line"></span><br><span class="line">var parentkey = favContextKey(&quot;parentKey&quot;)</span><br><span class="line">var childKey = favContextKey(&quot;childKey&quot;)</span><br><span class="line"></span><br><span class="line">func parent() &#123;</span><br><span class="line">	ctx := context.WithValue(context.Background(), parentkey, &quot;parentVal&quot;)</span><br><span class="line">	fmt.Printf(&quot;parentFn: parentVal: %+v\n&quot;, ctx.Value(parentkey))</span><br><span class="line">	child(context.WithValue(ctx, childKey, &quot;childVal&quot;))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func child(ctx context.Context) &#123;</span><br><span class="line">	fmt.Printf(&quot;childFn: parentVal: %+v\n&quot;, ctx.Value(parentkey))</span><br><span class="line">	fmt.Printf(&quot;childFn: childVal: %+v\n&quot;, ctx.Value(childKey))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	parent()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h2><p>一般是用依赖注入的方式，方便单元测试；但依赖也因此要显式地在代码里不断传递，一般是自行进行依赖管理，如果依赖多了就需要不少这样的代码，wire能够减少依赖管理的代理，使其更加简洁。<br>详情看官方文档示例，比较清晰：<a target="_blank" rel="noopener" href="https://github.com/google/wire/blob/main/_tutorial/README.md">https://github.com/google/wire/blob/main/_tutorial/README.md</a></p>
<h2 id="内存同步的方法与性能比较"><a href="#内存同步的方法与性能比较" class="headerlink" title="内存同步的方法与性能比较"></a>内存同步的方法与性能比较</h2><ol>
<li><p>方法：锁（互斥锁、读写锁、原子操作）, chan实现无（显示）阻塞的内存同步；</p>
</li>
<li><p>由于atomic使用的是copy-on-write的方法在多任务间共享内存，所以不适用于大量数据的共享；</p>
</li>
<li><p>性能：原子操作&gt; 读写锁 &gt;？互斥锁 &gt;? chan；<br>原子操作：使用的是操作系统提供的CAS，不需要进行进程、线程或goroutine的切换；<br>读写锁、互斥锁：需要暂停其它goroutine，只保留相关的goroutine，涉及到goroutine的唤醒、暂停及其上下文切换的消耗；<br>chan：使用互斥锁实现，但其核心思想在于避免显示加锁，用通信的方式解决内存共享的多goroutine编程问题，因为锁编程的复杂度可能带来死锁、活锁、资源耗尽等风险；</p>
</li>
</ol>
<p>go写并发的核心思想:</p>
<blockquote>
</blockquote>
<p>Share memory by communicating, don’t communicate by sharing memory.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">package concurrency</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;sync&quot;</span><br><span class="line">	&quot;sync/atomic&quot;</span><br><span class="line">	&quot;testing&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type Config struct &#123;</span><br><span class="line">	a []int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var readerCount = 1</span><br><span class="line"></span><br><span class="line">func BenchmarkMutexMultipleReaders(b *testing.B) &#123;</span><br><span class="line">	var lastValue uint64</span><br><span class="line">	var lock sync.RWMutex</span><br><span class="line">	cfg := Config&#123;</span><br><span class="line">		a: []int&#123;0, 0, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	var wg sync.WaitGroup</span><br><span class="line">	for n := 0; n &lt; readerCount; n++ &#123;</span><br><span class="line">		wg.Add(1)</span><br><span class="line">		go func() &#123;</span><br><span class="line">			for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">				lock.RLock()</span><br><span class="line">				atomic.SwapUint64(&amp;lastValue, uint64(cfg.a[0]))</span><br><span class="line">				lock.RUnlock()</span><br><span class="line">			&#125;</span><br><span class="line">			wg.Done()</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func BenchmarkAtomicMultipleReaders(b *testing.B) &#123;</span><br><span class="line">	var lastValue uint64</span><br><span class="line">	var v atomic.Value</span><br><span class="line">	cfg := Config&#123;</span><br><span class="line">		a: []int&#123;0, 0, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">	v.Store(cfg)</span><br><span class="line"></span><br><span class="line">	var wg sync.WaitGroup</span><br><span class="line">	for n := 0; n &lt; readerCount; n++ &#123;</span><br><span class="line">		wg.Add(1)</span><br><span class="line">		go func() &#123;</span><br><span class="line">			for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">				d := v.Load().(Config)</span><br><span class="line">				atomic.SwapUint64(&amp;lastValue, uint64(d.a[0]))</span><br><span class="line">			&#125;</span><br><span class="line">			wg.Done()</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func BenchmarkMutexOneWriterMultipleReaders(b *testing.B) &#123;</span><br><span class="line">	var lastValue uint64</span><br><span class="line">	var lock sync.RWMutex</span><br><span class="line">	var cfg = Config&#123;</span><br><span class="line">		a: []int&#123;0, 0, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		var i = 0</span><br><span class="line">		for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">			i++</span><br><span class="line">			lock.Lock()</span><br><span class="line">			cfg = Config&#123;</span><br><span class="line">				a: []int&#123;i, i + 1, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">			&#125;</span><br><span class="line">			lock.Unlock()</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	var wg sync.WaitGroup</span><br><span class="line">	for n := 0; n &lt; readerCount; n++ &#123;</span><br><span class="line">		wg.Add(1)</span><br><span class="line">		go func() &#123;</span><br><span class="line">			for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">				lock.RLock()</span><br><span class="line">				atomic.SwapUint64(&amp;lastValue, uint64(cfg.a[0]))</span><br><span class="line">				lock.RUnlock()</span><br><span class="line">			&#125;</span><br><span class="line">			wg.Done()</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func BenchmarkAtomicOneWriterMultipleReaders(b *testing.B) &#123;</span><br><span class="line">	var lastValue uint64</span><br><span class="line">	var v atomic.Value</span><br><span class="line">	var cfg = Config&#123;</span><br><span class="line">		a: []int&#123;0, 0, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">	v.Store(cfg)</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		var i = 0</span><br><span class="line">		for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">			i++</span><br><span class="line">			cfg = Config&#123;</span><br><span class="line">				a: []int&#123;i, i + 1, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">			&#125;</span><br><span class="line">			v.Store(cfg)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	var wg sync.WaitGroup</span><br><span class="line">	for n := 0; n &lt; readerCount; n++ &#123;</span><br><span class="line">		wg.Add(1)</span><br><span class="line">		go func() &#123;</span><br><span class="line">			for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">				d := v.Load().(Config)</span><br><span class="line">				atomic.SwapUint64(&amp;lastValue, uint64(d.a[0]))</span><br><span class="line">			&#125;</span><br><span class="line">			wg.Done()</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func BenchmarkChanOneWriterMultipleReaders(b *testing.B) &#123;</span><br><span class="line">	rc := make(chan int, 1000)</span><br><span class="line">	b.ResetTimer()</span><br><span class="line">	var lastValue uint64</span><br><span class="line">	var cfg = Config&#123;</span><br><span class="line">		a: []int&#123;0, 0, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		var i = 0</span><br><span class="line">		for msg := range rc &#123;</span><br><span class="line">			i++</span><br><span class="line">			switch msg &#123;</span><br><span class="line">			case 0:</span><br><span class="line">				cfg = Config&#123;</span><br><span class="line">					a: []int&#123;i, i + 1, 0, 0, 0, 0, 0&#125;,</span><br><span class="line">				&#125;</span><br><span class="line">			case 1:</span><br><span class="line">				atomic.SwapUint64(&amp;lastValue, uint64(cfg.a[0]))</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	go func() &#123;</span><br><span class="line">		for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">			rc &lt;- 0</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	var wg sync.WaitGroup</span><br><span class="line">	for n := 0; n &lt; readerCount; n++ &#123;</span><br><span class="line">		wg.Add(1)</span><br><span class="line">		go func() &#123;</span><br><span class="line">			for n := 0; n &lt; b.N; n++ &#123;</span><br><span class="line">				rc &lt;- 1</span><br><span class="line">			&#125;</span><br><span class="line">			wg.Done()</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>readerCounts为4的结果：<br><img src="https://img.yangrunwei.com/article-img/20210314/0a2b835d-ab27-4259-8180-6372aceaa978--1615299738739-3c0a9e90-bd03-4cb3-847e-352ddee2133c-image-resized.png"></p>
<p>readerCounts为1的结果：<br><img src="https://img.yangrunwei.com/article-img/20210314/23faf5c8-3537-4ccf-9426-d1502b03e55e--1615368652875-11ba810d-a4ea-448d-96c9-a4ce67bd24b0-image-resized.png"></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://www.ardanlabs.com/blog/2018/11/goroutine-leaks-the-forgotten-sender.html">goroutine-leak</a><br><a target="_blank" rel="noopener" href="https://medium.com/a-journey-with-go/go-how-to-reduce-lock-contention-with-the-atomic-package-ba3b2664b549">atomic vs mutex</a><br><a target="_blank" rel="noopener" href="https://medium.com/a-journey-with-go/go-discovery-of-the-trace-package-e5a821743c3c">go-trace</a></p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2015 - 2022 By 杨润炜</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>